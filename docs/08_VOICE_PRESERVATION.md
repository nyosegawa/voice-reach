# 08 — 音声保存プロトコルと音声合成

## 1. なぜ音声保存がタイムクリティカルか

ALS患者の構音障害は不可逆的に進行する。PVPで「何を言うか」は後から構築できるが、「どんな声で言うか」は発話能力が残っているうちに録音しなければ取り返しがつかない。

```
          発症              構音障害の進行         発話不能
 ──────────┼─────────────────────┼─────────────────┼──
           │                     │                 │
           │◀── 録音可能期間 ──▶│                 │
           │                     │                 │
           │  ここを逃すと       │  もう録れない    │
           │  声は失われる       │                 │
```

このため、音声保存はプロダクトの完成を待たずに先行してプロトコルを確立し、診断直後から実施を推奨すべきである。

---

## 2. 録音プロトコル

### 2.1 最小録音セット（30分〜1時間）

最近の音声合成技術（XTTS、VALL-E系）では数分〜数十分の音声データで高品質なクローニングが可能になりつつある。ただし品質を確保するために以下を推奨する。

```
セッション1: 基本音素カバレッジ（15分）
  - 日本語の全音素を含む文章セットを朗読
  - 清音・濁音・半濁音・拗音・促音・長音をすべて網羅
  - 文章は自然な会話文（不自然な音素練習文ではなく）

セッション2: 感情トーンバリエーション（15分）
  - ニュートラル: 普段の話し方で自由会話
  - 嬉しい: 楽しいエピソードを話す
  - 落ち着き: ゆっくり静かに話す
  - 強調: 力強く意見を述べる
  - 優しい: 家族に語りかけるように

セッション3: 個人特有の表現（15分）
  - 口癖や頻用フレーズを繰り返し発話
  - 笑い声（鼻で笑う、声を出して笑う等）
  - 相槌パターン（「うん」「そうだね」「へぇ」等）
  - 感嘆表現（「すごい」「まじか」「やばい」等）

セッション4: 自由会話（15分以上、可能な限り長く）
  - 家族との自然な会話を録音
  - 最も「その人らしい」声が録れる
```

### 2.2 録音環境要件

```
必須:
  - 静かな部屋（エアコン音、テレビ音等を消す）
  - サンプリングレート: 44.1kHz以上
  - ビット深度: 16bit以上
  - マイク: コンデンサーマイク推奨（なければスマートフォンでも可）
  - マイク距離: 口元から20〜30cm

推奨:
  - ポップフィルター（破裂音のノイズ防止）
  - 反響の少ない部屋（布が多い部屋が良い）
  - 複数セッションに分割（疲労防止）
```

### 2.3 既存音声データの活用

新規録音が十分にできない場合や、すでに構音障害が進行している場合。

```
活用可能なソース:
  - 留守番電話メッセージ
  - ビデオ通話の録画（Zoom, LINE等）
  - ホームビデオ
  - 結婚式のスピーチ
  - 仕事のプレゼン録画
  - SNSの音声メッセージ
  - 会議録音

処理パイプライン:
  1. 音源収集 → 話者分離で患者の音声のみ抽出
  2. ノイズ除去（背景音、反響等）
  3. 音質正規化（ラウドネス、サンプリングレート統一）
  4. セグメント化（発話単位に分割）
  5. テキスト対応付け（ASRで文字起こし → 手動修正）
  6. 品質スコアリング（S/N比、明瞭度で品質を数値化）
  7. 高品質セグメントのみを訓練データに使用
```

### 2.4 構音障害が進行している場合

```
声が既に変化している場合の選択肢:

選択肢A: 現在の声を使う
  - 本人が「今の声でいい」と判断した場合
  - 録音し、現在の声でクローニング

選択肢B: 過去の声を復元する
  - 既存の音声データ（ビデオ等）から抽出
  - データ量が少ない場合、品質は低下する可能性
  - 本人/家族の同意のもとで実施

選択肢C: 両方を用意する
  - 状況に応じて切替可能にする
  - 進行に合わせて、過去の声への移行を段階的に
```

---

## 3. 音声合成システム

### 3.1 技術候補

| 技術 | 特徴 | 必要データ量 | 品質 |
|---|---|---|---|
| XTTS v2 | オープンソース、多言語対応 | 6秒〜数分 | 中〜高 |
| StyleTTS 2 | スタイル制御が強い | 数十分 | 高 |
| VALL-E X | Microsoft研究、多言語 | 3秒〜 | 高（非公開） |
| Coqui TTS | オープンソース、使いやすい | 数分〜 | 中 |
| カスタム訓練 | 大量データで最高品質 | 数時間 | 最高 |

### 3.2 合成パイプライン

```
テキスト入力（患者が選択した候補）
  ↓
[前処理]
  - テキスト正規化（数字、略語の展開）
  - 読み推定（漢字→ふりがな）
  - アクセント・イントネーション推定
  ↓
[感情/トーン制御]
  - PVPの対人スタイルから基本トーンを決定
  - 患者の感情状態（valence/arousal）を反映
  - 手動トーン選択があればそれを優先
  ↓
[音声合成エンジン]
  - 保存した声のクローンモデルで波形生成
  - 話速制御（PVPの pace パラメータ）
  ↓
[後処理]
  - ノイズ除去
  - ラウドネス正規化
  ↓
スピーカー出力
```

### 3.3 トーン制御の具体例

```
テキスト: "ありがとう"

相手: 妻   → 穏やかで温かいトーン、ややゆっくり
相手: 医師 → 丁寧でニュートラルなトーン
相手: 孫   → 明るく楽しいトーン、やや高め

感情: positive, high arousal → 元気で明るい
感情: positive, low arousal  → 穏やかで温かい
感情: negative              → 静かで控えめ
```

### 3.4 声の経年保存

```
保存すべきデータ:
  1. 生録音データ（WAV、無圧縮）→ 永久保存
  2. クローンモデルのチェックポイント → バージョン管理
  3. 音声特徴量（話者埋め込みベクトル）→ 新技術への移行用
  4. メタデータ（録音条件、品質スコア等）

ストレージ:
  - ローカル: 生録音（容量が大きい）
  - クラウドバックアップ: 暗号化して保存
  - 複数コピー: 家族にもコピーを提供

将来の技術進歩への備え:
  生録音データがあれば、将来のより優れた合成技術で
  再度モデルを構築できる。特徴量だけでなく
  必ず生データを保存する。
```

---

## 4. 音声保存の早期開始プログラム

### 4.1 診断直後パッケージ

プロダクト完成を待たずに提供する、音声保存のための独立パッケージ。

```
提供物:
  1. 録音ガイドブック（PDF）
     - 録音環境のセットアップ方法
     - 読み上げ文章セット（音素網羅）
     - 自由会話のトピック提案

  2. 録音アプリ（スマートフォン）
     - ガイド付き録音セッション
     - 品質チェック（音量、ノイズレベルの自動判定）
     - セッション管理（進捗表示）

  3. データ保管サービス
     - 暗号化クラウドストレージ
     - 家族への共有機能
     - 将来のVoiceReach統合への引き継ぎ

提供タイミング: ALS診断後できるだけ早く
コスト: 無料または最小限（社会的使命として）
```

### 4.2 医療機関との連携

```
理想的なフロー:
  1. 神経内科医がALS診断を告知
  2. 診断後のサポートパッケージの一つとして音声保存を案内
  3. 言語聴覚士（ST）が録音セッションをサポート
  4. 構音障害の進行モニタリングと並行して追加録音
  5. 発話不能になった時点でクローン音声に切替
```

---

## 5. 倫理的考慮

### 5.1 本人の声の所有権

```
原則:
  - 録音データの所有権は患者本人に帰属
  - 患者の同意なしに第三者が使用することはできない
  - 患者の意思決定能力が低下した場合は法的代理人が管理

禁止事項:
  - クローン音声を使った患者本人以外の発話
  - 患者の同意のない範囲での音声データの利用
  - 商用目的での音声データの二次利用
```

### 5.2 患者死亡後のデータ

```
事前指示が必要な事項:
  - 死亡後の音声データの取り扱い（削除/保存/家族への引き渡し）
  - クローン音声モデルの存続可否
  - 家族が「故人の声」として使用する権利の有無
  - メモリアル目的（動画メッセージの作成等）の許可範囲

これらは事前指示書（Advance Directive）の一部として
患者の意思決定能力があるうちに記録しておく。
```
